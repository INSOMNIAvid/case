<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Реалистичная 3D Солнечная система</title>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background-color: #000;
        }
        canvas { 
            display: block; 
        }
        #info {
            position: absolute;
            top: 10px;
            width: 100%;
            text-align: center;
            color: white;
            font-family: Arial, sans-serif;
            pointer-events: none;
            text-shadow: 0 0 5px #000;
        }
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-family: Arial, sans-serif;
            font-size: 24px;
        }
    </style>
</head>
<body>
    <div id="info">Реалистичная 3D Солнечная система<br>Используйте мышь для навигации, колесо для масштабирования</div>
    <div id="loading">Загрузка текстур...</div>
    
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/TextureLoader.js"></script>

    <script>
        // Инициализация сцены, камеры и рендерера
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 5000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.body.appendChild(renderer.domElement);

        // Добавление управления камерой
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.minDistance = 5;
        controls.maxDistance = 3000;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.5;

        // Позиция камеры
        camera.position.set(0, 150, 300);

        // Загрузчик текстур
        const textureLoader = new THREE.TextureLoader();
        
        // Массив для хранения всех объектов
        const solarSystem = {
            sun: null,
            planets: [],
            dwarfPlanets: [],
            asteroids: []
        };

        // Функция создания звездного фона
        function createStars() {
            const starsGeometry = new THREE.BufferGeometry();
            const starsMaterial = new THREE.PointsMaterial({
                color: 0xFFFFFF,
                size: 0.1,
                transparent: true
            });

            const starsVertices = [];
            for (let i = 0; i < 30000; i++) {
                const x = (Math.random() - 0.5) * 4000;
                const y = (Math.random() - 0.5) * 4000;
                const z = (Math.random() - 0.5) * 4000;
                starsVertices.push(x, y, z);
            }

            starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
            const stars = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(stars);
        }

        // Создание солнца с текстурой и объемным эффектом
        function createSun() {
            const sunGeometry = new THREE.SphereGeometry(25, 128, 128);
            const sunTexture = textureLoader.load('https://threejs.org/examples/textures/planets/sun_surface.jpg');
            const sunMaterial = new THREE.MeshPhongMaterial({
                map: sunTexture,
                emissive: 0xffaa33,
                emissiveIntensity: 1,
                specular: 0xffffee,
                shininess: 50,
                transparent: true,
                opacity: 0.98
            });
            
            const sun = new THREE.Mesh(sunGeometry, sunMaterial);
            
            // Добавление свечения
            const glowGeometry = new THREE.SphereGeometry(28, 64, 64);
            const glowMaterial = new THREE.MeshBasicMaterial({
                color: 0xffaa00,
                transparent: true,
                opacity: 0.7,
                side: THREE.BackSide
            });
            const glow = new THREE.Mesh(glowGeometry, glowMaterial);
            sun.add(glow);
            
            // Солнечная корона
            const coronaGeometry = new THREE.SphereGeometry(35, 64, 64);
            const coronaMaterial = new THREE.MeshBasicMaterial({
                color: 0xff6600,
                transparent: true,
                opacity: 0.3,
                side: THREE.BackSide
            });
            const corona = new THREE.Mesh(coronaGeometry, coronaMaterial);
            sun.add(corona);
            
            // Точечный свет от солнца
            const pointLight = new THREE.PointLight(0xffffff, 2, 2000);
            pointLight.position.set(0, 0, 0);
            sun.add(pointLight);
            
            // Добавляем солнечные вспышки
            const flareTexture = textureLoader.load('https://threejs.org/examples/textures/lensflare/lensflare0.png');
            const flare = new THREE.Lensflare();
            flare.addElement(new THREE.LensflareElement(flareTexture, 100, 0, new THREE.Color(0xffffee)));
            flare.addElement(new THREE.LensflareElement(flareTexture, 60, 0.6, new THREE.Color(0xffffee)));
            flare.addElement(new THREE.LensflareElement(flareTexture, 70, 0.7, new THREE.Color(0xffffee)));
            flare.addElement(new THREE.LensflareElement(flareTexture, 120, 0.9, new THREE.Color(0xffff66)));
            flare.addElement(new THREE.LensflareElement(flareTexture, 70, 1, new THREE.Color(0xffaa33)));
            pointLight.add(flare);
            
            scene.add(sun);
            solarSystem.sun = sun;
            return sun;
        }

        // Создание планеты с текстурами
        function createPlanet(name, radius, position, rotationSpeed, orbitSpeed, textureUrl, bumpMapUrl, specularMapUrl, hasRing = false, ringColor = 0x888888) {
            const geometry = new THREE.SphereGeometry(radius, 64, 64);
            
            const textures = {
                map: textureLoader.load(textureUrl),
                bumpMap: bumpMapUrl ? textureLoader.load(bumpMapUrl) : null,
                bumpScale: bumpMapUrl ? 0.05 : 0,
                specularMap: specularMapUrl ? textureLoader.load(specularMapUrl) : null,
                specular: new THREE.Color(0x111111)
            };
            
            const material = new THREE.MeshPhongMaterial(textures);
            const planet = new THREE.Mesh(geometry, material);
            planet.name = name;
            planet.position.set(position.x, position.y, position.z);
            
            // Добавление кольца (если есть)
            if (hasRing) {
                const ringGeometry = new THREE.RingGeometry(radius * 1.5, radius * 2.2, 64);
                const ringMaterial = new THREE.MeshPhongMaterial({
                    color: ringColor,
                    side: THREE.DoubleSide,
                    transparent: true,
                    opacity: 0.8
                });
                const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                ring.rotation.x = Math.PI / 2;
                planet.add(ring);
            }
            
            // Сохраняем параметры для анимации
            planet.userData = {
                rotationSpeed: rotationSpeed,
                orbitSpeed: orbitSpeed,
                initialPosition: { ...position },
                orbitRadius: Math.sqrt(position.x * position.x + position.z * position.z)
            };
            
            scene.add(planet);
            solarSystem.planets.push(planet);
            return planet;
        }

        // Создание карликовой планеты
        function createDwarfPlanet(name, radius, position, rotationSpeed, orbitSpeed, textureUrl) {
            const geometry = new THREE.SphereGeometry(radius, 32, 32);
            const texture = textureLoader.load(textureUrl);
            const material = new THREE.MeshPhongMaterial({
                map: texture,
                specular: new THREE.Color(0x111111)
            });
            
            const planet = new THREE.Mesh(geometry, material);
            planet.name = name;
            planet.position.set(position.x, position.y, position.z);
            
            // Сохраняем параметры для анимации
            planet.userData = {
                rotationSpeed: rotationSpeed,
                orbitSpeed: orbitSpeed,
                initialPosition: { ...position },
                orbitRadius: Math.sqrt(position.x * position.x + position.z * position.z)
            };
            
            scene.add(planet);
            solarSystem.dwarfPlanets.push(planet);
            return planet;
        }

        // Создание астероидного пояса
        function createAsteroidBelt(count, innerRadius, outerRadius) {
            const asteroidGeometry = new THREE.SphereGeometry(0.5, 8, 8);
            const asteroidMaterial = new THREE.MeshPhongMaterial({
                color: 0xaaaaaa,
                shininess: 10
            });
            
            for (let i = 0; i < count; i++) {
                const asteroid = new THREE.Mesh(asteroidGeometry, asteroidMaterial);
                
                // Случайная позиция в поясе
                const angle = Math.random() * Math.PI * 2;
                const radius = innerRadius + Math.random() * (outerRadius - innerRadius);
                const height = (Math.random() - 0.5) * 20;
                
                asteroid.position.x = Math.cos(angle) * radius;
                asteroid.position.z = Math.sin(angle) * radius;
                asteroid.position.y = height;
                
                // Случайный размер и вращение
                const scale = 0.2 + Math.random() * 1.5;
                asteroid.scale.set(scale, scale, scale);
                asteroid.rotation.set(Math.random() * Math.PI, Math.random() * Math.PI, Math.random() * Math.PI);
                
                // Сохраняем параметры для анимации
                asteroid.userData = {
                    rotationSpeed: (Math.random() - 0.5) * 0.02,
                    orbitSpeed: (Math.random() * 0.001 + 0.0005) * (Math.random() > 0.5 ? 1 : -1)
                };
                
                scene.add(asteroid);
                solarSystem.asteroids.push(asteroid);
            }
        }

        // Создание галактики на заднем плане
        function createGalaxyBackground() {
            const geometry = new THREE.SphereGeometry(2000, 32, 32);
            const texture = textureLoader.load('https://threejs.org/examples/textures/galaxy/purple_nebula.jpg');
            const material = new THREE.MeshBasicMaterial({
                map: texture,
                side: THREE.BackSide,
                transparent: true,
                opacity: 0.3
            });
            const galaxy = new THREE.Mesh(geometry, material);
            scene.add(galaxy);
        }

        // Загрузка всех текстур и создание сцены
        function init() {
            createStars();
            createGalaxyBackground();
            createSun();
            
            // Создаем планеты с реалистичными текстурами
            createPlanet(
                'Меркурий', 4, { x: 40, y: 0, z: 0 }, 0.004, 0.01,
                'https://threejs.org/examples/textures/planets/mercury_map.jpg',
                'https://threejs.org/examples/textures/planets/mercury_bump.jpg'
            );
            
            createPlanet(
                'Венера', 6, { x: 70, y: 0, z: 0 }, 0.002, 0.008,
                'https://threejs.org/examples/textures/planets/venus_surface.jpg',
                null,
                'https://threejs.org/examples/textures/planets/venus_specular.jpg'
            );
            
            createPlanet(
                'Земля', 6.5, { x: 110, y: 0, z: 0 }, 0.01, 0.006,
                'https://threejs.org/examples/textures/planets/earth_atmos_2048.jpg',
                'https://threejs.org/examples/textures/planets/earth_normal_2048.jpg',
                'https://threejs.org/examples/textures/planets/earth_specular_2048.jpg'
            );
            
            createPlanet(
                'Марс', 5, { x: 150, y: 0, z: 0 }, 0.008, 0.004,
                'https://threejs.org/examples/textures/planets/mars_1k_color.jpg',
                'https://threejs.org/examples/textures/planets/mars_1k_topo.jpg'
            );
            
            // Пояс астероидов между Марсом и Юпитером
            createAsteroidBelt(1000, 180, 220);
            
            createPlanet(
                'Юпитер', 14, { x: 250, y: 0, z: 0 }, 0.02, 0.003,
                'https://threejs.org/examples/textures/planets/jupiter_2k.jpg'
            );
            
            createPlanet(
                'Сатурн', 12, { x: 350, y: 0, z: 0 }, 0.015, 0.002,
                'https://threejs.org/examples/textures/planets/saturn_2k.jpg',
                null, null, true, 0xddddbb
            );
            
            createPlanet(
                'Уран', 9, { x: 450, y: 0, z: 0 }, 0.01, 0.0015,
                'https://threejs.org/examples/textures/planets/uranus_2k.jpg',
                null, null, true, 0xaaddff
            );
            
            createPlanet(
                'Нептун', 9, { x: 520, y: 0, z: 0 }, 0.012, 0.001,
                'https://threejs.org/examples/textures/planets/neptune_2k.jpg'
            );
            
            // Карликовые планеты
            createDwarfPlanet(
                'Плутон', 3, { x: 600, y: 0, z: 0 }, 0.008, 0.0008,
                'https://threejs.org/examples/textures/planets/pluto_map.jpg'
            );
            
            createDwarfPlanet(
                'Церера', 2, { x: 200, y: 0, z: 0 }, 0.006, 0.0025,
                'https://threejs.org/examples/textures/planets/ceres_map.jpg'
            );
            
            createDwarfPlanet(
                'Хаумеа', 2.5, { x: 650, y: 0, z: 50 }, 0.015, 0.0007,
                'https://threejs.org/examples/textures/planets/haumea_map.jpg'
            );
            
            createDwarfPlanet(
                'Макемаке', 2.3, { x: 580, y: 0, z: -80 }, 0.01, 0.0009,
                'https://threejs.org/examples/textures/planets/makemake_map.jpg'
            );
            
            createDwarfPlanet(
                'Эрида', 3.2, { x: 700, y: 0, z: 0 }, 0.009, 0.0006,
                'https://threejs.org/examples/textures/planets/eris_map.jpg'
            );
            
            // Убираем загрузочный экран
            document.getElementById('loading').style.display = 'none';
        }

        // Анимация
        function animate() {
            requestAnimationFrame(animate);
            
            // Вращение солнца
            if (solarSystem.sun) {
                solarSystem.sun.rotation.y += 0.001;
            }
            
            // Анимация планет
            solarSystem.planets.forEach(planet => {
                // Вращение вокруг своей оси
                planet.rotation.y += planet.userData.rotationSpeed;
                
                // Орбитальное движение
                const time = Date.now() * 0.001;
                const angle = time * planet.userData.orbitSpeed;
                planet.position.x = Math.cos(angle) * planet.userData.orbitRadius;
                planet.position.z = Math.sin(angle) * planet.userData.orbitRadius;
            });
            
            // Анимация карликовых планет
            solarSystem.dwarfPlanets.forEach(planet => {
                planet.rotation.y += planet.userData.rotationSpeed;
                
                const time = Date.now() * 0.001;
                const angle = time * planet.userData.orbitSpeed;
                planet.position.x = Math.cos(angle) * planet.userData.orbitRadius;
                planet.position.z = Math.sin(angle) * planet.userData.orbitRadius;
            });
            
            // Анимация астероидов
            solarSystem.asteroids.forEach(asteroid => {
                asteroid.rotation.x += asteroid.userData.rotationSpeed;
                asteroid.rotation.y += asteroid.userData.rotationSpeed * 0.5;
                
                const angle = Date.now() * 0.001 * asteroid.userData.orbitSpeed;
                const radius = Math.sqrt(asteroid.position.x * asteroid.position.x + asteroid.position.z * asteroid.position.z);
                asteroid.position.x = Math.cos(angle) * radius;
                asteroid.position.z = Math.sin(angle) * radius;
            });
            
            controls.update();
            renderer.render(scene, camera);
        }

        // Обработка изменения размера окна
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // Запуск инициализации после загрузки текстур
        init();
        animate();
    </script>
</body>
</html>
